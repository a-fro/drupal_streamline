#!/bin/bash

# This script starts guard and livereload for simplified theming

# Check to see if required gems are installed, and quit if not
if hash bundle 2>/dev/null; then
  bundle check
  BUNDLE_RET_CODE=$?

  if [ $BUNDLE_RET_CODE != 0 ]; then
    exit $BUNDLE_RET_CODE
  fi
else
  echo "bundle command not found. Be sure to install it from http://bundler.io/"
  exit 1
fi

# docroot/ will only exist if the init script has properly run
if [ ! -d "docroot" ]; then
  echo 'Please be sure that you are running this command from your project root and that you have run the init script.'
  exit 2
fi

cd docroot
drush en drupal_streamline_dev -y
drush vset drupal_streamline_dev_use_livereload TRUE

cd ../
bundle exec guard -i

cd docroot
drush vset drupal_streamline_dev_use_livereload FALSE

cd ../

exit 0
